@page "/profile"


<div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
    <main class="py-6 xl:col-span-2">
        <div class="bg-white rounded-lg shadow-sm">
            <div class="h-32 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-t-lg"></div>

            <div class="p-6">
                <div class="flex flex-col sm:flex-row sm:items-center">
                    <div class="-mt-16">
                        <img class="h-24 w-24 rounded-full border-4 border-white"
                             src="@($"https://placehold.co/96x96/{UserProfile.BackgroundColor}/FFFFFF?text={UserProfile.Username[0]}")"
                             alt="User Avatar" />
                    </div>

                    <div>
                        <div class="lg:-mt-3 sm:mt-0 sm:ml-4 flex-grow">
                            <h1 class="text-2xl font-bold text-gray-900">@UserProfile.DisplayName</h1>
                            <p class="text-sm text-gray-500 -mt-1">u/@UserProfile.Username</p>

                            <div class="mt-3 lg:mt-2 flex items-center space-x-6 text-sm text-gray-600 xl:hidden">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-orange-500" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.787l.09.044a2 2 0 002.208-.445l4.577-5.996a2 2 0 00.44-2.208l-.09-.044a2 2 0 00-2.208.445L9 12.333V4.5a1.5 1.5 0 00-3 0v5.833z" />
                                    </svg>
                                    <span class="font-semibold">@UserProfile.Karma.ToString("N0")</span>
                                    <span class="ml-1">Karma</span>
                                </div>
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-teal-500" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M5 5a3 3 0 015.252-2.121l.738.738a.5.5 0 00.708 0l.738-.738A3 3 0 0115 5v2.293l.53.53a1 1 0 010 1.414l-2 2a1 1 0 01-1.414 0l-1.293-1.293V15a1 1 0 01-1-1v-2.293l-1.293 1.293a1 1 0 01-1.414 0l-2-2a1 1 0 010-1.414l.53-.53V5zm2 5.707l1.293-1.293a1 1 0 011.414 0L12 12.707V15a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2.293z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="font-semibold">@UserProfile.CakeDay.ToString("MMM d, yyyy")</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 sm:hidden">
                        <a href="edit_profile"
                           class="w-full flex justify-center bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 transition text-sm">
                            Edit Profile
                        </a>
                    </div>

                    <div class="hidden sm:block sm:ml-auto">
                        <a href="edit_profile"
                           class="w-auto flex justify-center bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 transition text-sm">
                            Edit Profile
                        </a>
                    </div>

                </div>

                <div class="mt-6 border-t border-gray-200 pt-6">
                    <h3 class="text-sm font-bold text-gray-700">About Me</h3>
                    <p class="text-gray-600 mt-2">@UserProfile.AboutMe</p>
                </div>
            </div>

            <div class="border-t border-gray-200">
                <nav class="flex space-x-4 px-6" aria-label="Tabs">
                    <button @onclick='() => SetActiveTab("posts")' class="tab-btn font-semibold py-4 px-1 border-b-2 text-sm @(_activeTab == "posts" ? "tab-active" : "text-gray-600 hover:text-blue-600 border-transparent")">
                        Posts
                    </button>
                    <button @onclick='() => SetActiveTab("communities")' class="tab-btn font-semibold py-4 px-1 border-b-2 text-sm @(_activeTab == "communities" ? "tab-active" : "text-gray-600 hover:text-blue-600 border-transparent")">
                        Communities
                    </button>
                </nav>
            </div>
        </div>

        <div class="mt-6">
            @if (_activeTab == "posts")
            {
                <div class="space-y-4">
                    @if (UserProfile.Posts.Any())
                    {
                        @foreach (var post in UserProfile.Posts)
                        {
                            <div class="bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow">
                                <div class="flex items-center mb-2">
                                    <img class="h-6 w-6 rounded-full" src="@post.CommunityIconUrl" alt="community icon" />
                                    <p class="ml-2 text-sm">
                                        <span class="font-bold text-gray-800">@post.CommunityName</span>
                                        <span class="text-gray-500"> · Posted by u/@UserProfile.Username @post.TimeAgo</span>
                                    </p>
                                </div>
                                <h3 class="text-lg font-bold text-gray-900 mb-1">@post.Title</h3>
                                <p class="text-gray-700">@post.Content</p>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="bg-white rounded-lg shadow-sm p-6 text-center">
                            <p class="text-gray-500">This user hasn't made any posts yet.</p>
                        </div>
                    }
                </div>
            }

            @if (_activeTab == "communities")
            {
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="font-bold text-lg mb-4">Joined Communities</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        @foreach (var community in UserProfile.Communities)
                        {
                            <div class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50">
                                <img class="h-10 w-10 rounded-full" src="@community.IconUrl" alt="community icon" />
                                <div>
                                    <p class="font-bold text-gray-800">@community.Name</p>
                                    <p class="text-sm text-gray-500">@community.Members members</p>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>
    </main>

    <aside class="hidden xl:block py-6">
        <div class="sticky top-6">
            <div class="bg-white rounded-lg shadow-sm p-4">
                <div class="flex items-center space-x-3 mb-4">
                    <img class="h-12 w-12 rounded-full"
                         src="@($"https://placehold.co/96x96/{UserProfile.BackgroundColor}/FFFFFF?text={UserProfile.Username[0]}")"
                         alt="User Avatar" />
                    <div>
                        <h4 class="font-bold text-gray-800">u/@UserProfile.Username</h4>
                        <p class="text-xs text-gray-500">@UserProfile.DisplayName</p>
                    </div>
                </div>
                <div class="space-y-6">
            <!-- User Stats Card -->
            <div class="bg-white border border-gray-200 rounded-xl p-6 shadow-sm">
                <h4 class="font-bold text-gray-900 mb-4 flex items-center">
                    <svg class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                    Your Stats
                </h4>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-orange-50 rounded-lg border border-orange-100">
                        <div class="flex items-center">
                            <svg class="h-5 w-5 text-orange-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                            </svg>
                            <span class="font-medium text-gray-700">Karma</span>
                        </div>
                        <span class="text-lg font-bold text-orange-600">1,245</span>
                    </div>

                    <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-100">
                        <div class="flex items-center">
                            <svg class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            <span class="font-medium text-gray-700">Cake Day</span>
                        </div>
                        <span class="text-sm font-medium text-blue-600">Jan 15, 2022</span>
                    </div>
                </div>
            </div>
                </div>
            </div>
        </div>
    </aside>
</div>

@code {
    private bool _isLoading = true;
    private string _activeTab = "posts";
    private ProfileData UserProfile;

    protected override void OnInitialized()
    {
        // Load mockup data
        UserProfile = new ProfileData
            {
                Username = "current_user",
                DisplayName = "current_user",
                AboutMe = "A passionate developer and designer exploring the world of web technologies. This is a placeholder bio from the profile page.",
                BackgroundColor = "6366F1",
                Karma = 1234,
                CakeDay = new DateTime(2025, 8, 21),
                Posts = new List<PostData>
            {
                new PostData
                {
                    CommunityName = "r/webdev",
                    CommunityIconUrl = "https://placehold.co/32x32/059669/FFFFFF?text=W",
                    TimeAgo = "2 hours ago",
                    Title = "Just launched my new portfolio site with Tailwind CSS!",
                    Content = "After weeks of work, I'm excited to share my new personal website..."
                },
                new PostData
                {
                    CommunityName = "r/design",
                    CommunityIconUrl = "https://placehold.co/32x32/7E22CE/FFFFFF?text=D",
                    TimeAgo = "1 day ago",
                    Title = "What are your favorite tools for creating mockups in 2025?",
                    Content = "Hey everyone, my team is looking to switch up our design workflow..."
                }
            },
                Communities = new List<CommunityData>
            {
                new CommunityData { Name = "r/webdev", IconUrl = "https://placehold.co/40x40/059669/FFFFFF?text=W", Members = "2.1m" },
                new CommunityData { Name = "r/design", IconUrl = "https://placehold.co/40x40/7E22CE/FFFFFF?text=D", Members = "1.8m" }
            }
            };

        _isLoading = false;
    }

    private void SetActiveTab(string tabName)
    {
        _activeTab = tabName;
    }

    // --- Data Models for Mockup ---
    public class ProfileData
    {
        public string Username { get; set; }
        public string DisplayName { get; set; }
        public string AboutMe { get; set; }
        public string BackgroundColor { get; set; }
        public int Karma { get; set; }
        public DateTime CakeDay { get; set; }
        public List<PostData> Posts { get; set; }
        public List<CommunityData> Communities { get; set; }
    }

    public class PostData
    {
        public string CommunityName { get; set; }
        public string CommunityIconUrl { get; set; }
        public string TimeAgo { get; set; }
        public string Title { get; set; }
        public string Content { get; set; }
    }

    public class CommunityData
    {
        public string Name { get; set; }
        public string IconUrl { get; set; }
        public string Members { get; set; }
    }
}
